<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>echarts图表演示</title>
    <link rel="stylesheet" href="./style.css">
    <!-- 通过CDN引入ECharts库 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="./index.js"></script>
    <style>
        .charts-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .chart-wrapper {
            flex: 1;
            min-width: 400px;
            border: 1px solid #eee;
            border-radius: 5px;
            padding: 15px;
            background-color: #fff;
        }

        .chart-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
            text-align: center;
        }

        .chart {
            width: 100%;
            height: 400px;
        }
    </style>
</head>

<body>
    <h1>ECharts 图表演示</h1>

    <div class="control-panel">
        <p>这是一个使用 ECharts 展示饼图和柱状图的示例页面。</p>
    </div>

    <div id="app" class="charts-container">
        <template>
            <!-- 饼图容器 -->
            <div class="chart-wrapper">
                <div class="chart-title">用户分布饼图</div>
                <vs-echart id="pie-chart" class="chart" :options="pieOption"></vs-echart>
            </div>

            <!-- 柱状图容器 -->
            <div class="chart-wrapper">
                <div class="chart-title">月度销售额柱状图</div>
                <vs-echart id="bar-chart" class="chart" :options="barOption"></vs-echart>
            </div>
        </template>
    </div>

    <script>
        const app = vs.createApp({
            createComponents: ['echart'],
            data() {
                return {
                    pieOption: {
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b}: {c} ({d}%)'
                        },
                        legend: {
                            orient: 'vertical',
                            left: 'left',
                            data: ['移动端', '桌面端', '平板端', '其他设备']
                        },
                        series: [
                            {
                                name: '用户来源',
                                type: 'pie',
                                radius: '70%',
                                center: ['50%', '60%'],
                                data: [
                                    { value: 480, name: '移动端' },
                                    { value: 320, name: '桌面端' },
                                    { value: 120, name: '平板端' },
                                    { value: 80, name: '其他设备' }
                                ],
                                emphasis: {
                                    itemStyle: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                },
                                itemStyle: {
                                    borderRadius: 10,
                                    borderColor: '#fff',
                                    borderWidth: 2
                                }
                            }
                        ]
                    },
                    barOption: {
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        xAxis: [
                            {
                                type: 'category',
                                data: ['1月', '2月', '3月', '4月', '5月', '6月'],
                                axisTick: {
                                    alignWithLabel: true
                                }
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value'
                            }
                        ],
                        series: [
                            {
                                name: '销售额',
                                type: 'bar',
                                barWidth: '60%',
                                data: [18000, 22000, 16000, 25000, 30000, 28000],
                                itemStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        {
                                            offset: 0,
                                            color: '#83bff6'
                                        },
                                        {
                                            offset: 0.5,
                                            color: '#188df0'
                                        },
                                        {
                                            offset: 1,
                                            color: '#188df0'
                                        }
                                    ])
                                }
                            }
                        ]
                    }
                };
            },
            created() {
                // 定期更新图表数据
                setInterval(() => {
                    // 更新饼图数据
                    const pieData = this.pieOption.series[0].data;
                    pieData.forEach(item => {
                        item.value = Math.floor(item.value * (0.95 + Math.random() * 0.1));
                    });
                    this.setVariable('pieOption', this.pieOption, true);
                    
                    // 更新柱状图数据
                    const barData = this.barOption.series[0].data;
                    barData.forEach((item, index) => {
                        barData[index] = Math.floor(item * (0.95 + Math.random() * 0.1));
                    });
                    this.setVariable('barOption', this.barOption, true);
                }, 5000);
            }
        });
        app.mount('#app');
    </script>
</body>
</html>